# Purpose:
#   Sync periodic a feature branch instance
#
# Dependency:
#   XIMA Deployer Tools
#
variables:
  SCHEDULE_TASK_NAME: "sync:feature:scheduled"

sync:feature:scheduled:
  stage: sync
  extends:
    - .ssh
    - .deploy-base-feature
    - .base-schedule
  dependencies: [ ]
  variables:
    GIT_STRATEGY: fetch
  script:
    # install deployment dependencies
    - composer install --ignore-platform-reqs --optimize-autoloader --no-ansi --no-interaction --no-progress --no-scripts
    # sync stage
    - vendor/bin/dep feature:sync stage --feature=$CI_COMMIT_REF_NAME $DEPLOYER_CONFIG_ADDITIONAL_OPTION
